{extend name="common/base"}
{block name="content-header"}
<link rel="stylesheet" href="__STATIC__/admin/plugins/select2/select2.min.css">
    <h1>
        {$module_names[0]}
        <small>
        {$module_names[1]}</small>
    </h1>
    <ol class="breadcrumb">
        {volist name="module_names" id="vo"}
            <li {if condition="$module_nums==$key"}class="active"{/if}>{if condition="0==$key"}<i class="fa fa-dashboard"></i>{/if} {$vo}</li>
        {/volist}
    </ol>
{/block}

{block name="content"}
        <div class="container-fluid">
            <div class="pull-right">
                <a href="javascript:history.go(-1)" data-toggle="tooltip" title="" class="btn btn-default" data-original-title="返回管理员列表"><i class="fa fa-reply"></i></a>
            </div>
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title"><i class="fa fa-list"></i> 添加管理员</h3>
                </div>
                <div class="panel-body ">
                    <!--表单数据-->
                    <form method="post" id="js_upForm" action="{:url('admin/module/add')}">
                        <!--通用信息-->
                    <div class="tab-content col-md-10">
                        <div class="tab-pane active" id="tab_tongyong">
                            <table class="table table-bordered">
                                <tbody>
                                <tr>
                                    <td class="col-sm-2">菜单名称：</td>
                                    <td class="col-sm-8">
                                        <input type="text" class="form-control required" name="module_name" value="" >

                                    </td>
                                </tr>
                                <tr>
                                    <td>模块：</td>
                                    <td>
                                        <input type="text" class="form-control required" name="module" value="" >
                                    </td>
                                </tr>
                                <tr>
                                    <td>控制器：</td>
                                    <td >
                         				<input type="text" class="form-control required" name="controller" value="" >

                                    </td>
                                </tr>
                                <tr>
                                    <td>方法：</td>
                                    <td >
                                        <input type="text" class="form-control required" name="action" value="" >

                                    </td>
                                </tr>
                                <tr>
                                    <td>父级菜单的ID：</td>
                                    <td >
                                        <div class="col-sm-3">
                                            <select class="form-control required parent_id" name="parent_id">
                                                <option value="">请选择</option>
                                                <option value="0">顶级菜单</option>
                                                {volist name="list" id="v"}
                                                    <option value="{$v.id}">{$v.level-1|str_repeat="--------", ###}{$v.module_name}</option>
                                                {/volist}
                                            </select>
                                        </div>
                                        <div class="col-sm-3">
                                        </div>
                                        <div class="col-sm-3">
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>描述：</td>
                                    <td >
                                        <input type="text" class="form-control required" name="description" value="" >
                                    </td>
                                </tr>
                                <tr>
                                    <td>是否显示：</td>
                                    <td >
                                        <input checked="checked" type="radio" name="if_display" value="1"> 是
                                        <input type="radio" name="if_display" value="0"> 否
                                    </td>
                                </tr>
                                <tr>
                                    <td>是否为URL链接：</td>
                                    <td >
                                        <input checked="checked" type="radio" name="if_url" value="1"> 是
                                        <input type="radio" name="if_url" value="0"> 否
                                    </td>
                                </tr>
                                </tbody>
                                <tfoot>
                                	<tr>
                                	<td></td>
                                	<td class="text-left"><input class="btn btn-primary js_submit" type="button" value="保存"></td></tr>
                                </tfoot>
                                </table>
                        </div>
                    </div>
			    	</form><!--表单数据-->
                </div>
            </div>
        </div>
{/block}

{block name="script"}
<script>

$('.js_submit').on('click',function(){
  $("#js_upForm").submit();
});

$("#js_upForm").validate({
    submitHandler : function(){
        var url = $("#js_upForm").attr("action");
        $.ajax({
            url : url,
            type : "post",
            dataType : "json",
            data : $("#js_upForm").serialize(),
            success : function(res){
                console.log(res);
                if( res.status == true ){
                    location.href = res.url;
                }else {
                    layer.alert(res.msg, {icon: 2});
                }
            }
        });
    }
});

</script>
{/block}