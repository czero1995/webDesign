<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
		<title>分类</title>
		<script src="../js/rem.js"></script>
		<link rel="stylesheet" href="../css/base.css">
		<link rel="stylesheet" href="../css/category.css" />
	</head>

	<body>
		<div id="app">
			<div class="top" id="topBar">
				<p>分类</p>
			</div>
			<div class="container inlinkFlex">
				<div class="leftbar" >
					<div class="barItem"  v-for="menuItem in menuList">
						<p :class="{active:bar === menuItem.id}"  class="menu-text" @click="onBar(menuItem.id)">
							{{menuItem.cat_name}}
						</p>
					</div>					
				</div>
				<div class="rightContent" >
					<div>
						<div class="rightItem" v-for="categoryItem in categoryList" >
							<div class="category-item inlinkFlex">
								<a :href="'detail.html?id='+categoryItem.id">
									<div class="goods-img">
										<img :src="categoryItem.goods_thumb" />
									</div>
									<div class="goods-textBox">
										<p class="goods-name text-ellipsis">{{categoryItem.goods_name}}</p>
										<p class="goods-coach">¥{{categoryItem.present_price}}</p>
								</a>
								<div class="goods-cartBox">
									<img src="../img/icon/shop_addCart.png" @click.stop="onAddCart(categoryItem.id,categoryItem.goods_name)"  />
								</div>
								</div>
	
							</div>
						</div>
					</div>
				</div>
				<div class="footer inlinkFlex-around">
					<div class="footer-item">
						<a href="../index.html">
							<i class="icon footerIcon footerHomeIcon"></i>
							<p class="footer-title">首页</p>
						</a>
					</div>
					<div class="footer-item active">
						<a href="categotry.html">
							<i class="icon footerIcon footerCategoryIcon"></i>
							<p class="footer-title">分类</p>
						</a>
					</div>
					<div class="footer-item">
						<a href="cart.html">
							<i class="icon footerIcon footerCartIcon"></i>
							<p class="footer-title">购物车</p>
						</a>
					</div>
					<div class="footer-item">
						<a href="member.html">
							<i class="icon footerIcon footerMemberIcon"></i>
							<p class="footer-title">我的</p>
						</a>
					</div>
				</div>
				<!--提示成功弹窗-->
			<div class="model" v-show="successModel">
				<div class="model-content tip-content">
					<p>{{goodsName}} 	添加成功</p>
					<p @click="successModel=false">确定</p>
				</div>
			</div>
			</div>

		</div>
		<script src="../js/axios.js"></script>
		<script src="../js/http.js"></script>
		<script src="../js/vue.js"></script>
		<script>
			new Vue({
				el: '#app',
				data() {
					return {
						bar: 1,
						menuList:[],/*分类栏目*/	
						categoryList:[],/*分裂列表*/
						goodsName:'', /*商品名字*/
						successModel:false,
					}
				},
				mounted: function() {
					this.getMenuList();
					this.getCategoryList();
				},
				methods: {
					/*获取分类栏目*/
					getMenuList: function() {
						const that = this;
						axios.post(path + 'category/getCategoryList', {
						}).then(function(res) {
								that.menuList = res.data.data.data;
								console.log('menuDate',that.menuList);
							})
							.catch(function(error) {
								console.log(error);
							});
					},
					/*获取分类列表*/
					getCategoryList: function() {
						const that = this;
						axios.post(path + 'goods/getGoodsList?cat_id=1', {
						}).then(function(res) {
								that.categoryList = res.data.data.data;
								console.log('categoryDate',that.categoryList);
							})
							.catch(function(error) {
								console.log(error);
							});
					},
					/*切换分类*/
					onBar(id) {
						const that = this;
						that.bar = id;						
						console.log(that.bar);
						axios.post(path + 'goods/getGoodsList?cat_id='+id, {
						}).then(function(res) {
							that.categoryList=res.data.data.data
								console.log('商品列表',that.categoryList);
							})
							.catch(function(error) {
								console.log(error);
							});
					},
					/*添加到购物车*/
					onAddCart(id,name) {
						const that = this;						
						axios.post(path + 'cart/addGoodsInCart/', {
							'goods_id':id,
							'goods_number': 1,
						}).then(function(res) {
							if(res.data.errcode == 200){
								that.goodsName=name;
								that.successModel = true;
								
							}
								console.log('addcartData',res.data)
							})
							.catch(function(error) {
								console.log(error);
							});

					},

				}
			})
		</script>
	</body>

</html>