<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">

		<title>待支付</title>
		<script src="../js/rem.js"></script>
		<link rel="stylesheet" href="../css/base.css">
		<link rel="stylesheet" href="../css/paywait.css" />
	</head>

	<body>

		<div id="app">
			<div class="header clearfloat">
				<a href="javascript:history.back(-1)">
					<img src="../img/icon/arrowBack.png" />
				</a>
				<p>待支付</p>
			</div>
			<div class="container">

				<div class="order-item" v-for="orderItem in orderList">
					<div @click="onGoodsDetail(orderItem.id)">
						<div class="order-top inlinkFlex-spacebetween">
							<p>订单号: {{orderItem.order_sn}}</p>
							<p class="order-state">待支付</p>
						</div>
						<div class="order-content inlinkFlex" v-for="goodsItem in orderItem.goods_list">
							<div class="order-img">
								<img :src="goodsItem.goods_thumb" />
							</div>
							<div class="order-text ">
								<p class="order-name text-ellipsis">{{goodsItem.goods_name}}</p>
								<p class="order-num">x{{goodsItem.buy_number}}</p>
								<p class="order-coach">¥{{goodsItem.present_price}}</p>
							</div>

						</div>
						<div class="order-allCoach">
							<span>商品总额:</span>
							<span class="order-coach">¥{{orderItem.goods_amount}}</span>
						</div>
					</div>
					<div class="order-op inlinkFlex">
						<p @click="onCancel(orderItem.id)">取消订单</p>
						<p class="order-coach">支付</p>
					</div>
				</div>

			</div>

		</div>

		<script src="../js/axios.js"></script>
		<script src="../js/http.js"></script>
		<script src="../js/vue.js"></script>
		<script>
			new Vue({
				el: '#app',
				data() {
					return {
						orderList: [],
					}
				},
				mounted: function() {
					this.getOrderDetail();
				},
				methods: {
					/*获取订单列表*/
					getOrderDetail: function() {
						const that = this;
						axios.post(path + 'order/getorderList?pay_status=0', {}).then(function(res) {
								that.orderList = res.data.data.data;
								console.log('orderList', that.orderList);
							})
							.catch(function(error) {
								console.log(error);
							});
					},
					/*取消订单*/
					onCancel: function(id) {
						const that = this;
						axios.get(path + 'order/cancelOrderById?id=' + id, {
							
						}).then(function(res) {
								if(res.data.errcode == 200) {
									that.getOrderDetail();
								}
							})
							.catch(function(error) {
								console.log(error);
							});
					},
					/*进去订单详情*/
					onGoodsDetail(id) {
						const that = this;
						location.href = "paywaitDown.html?id=" + id;

					},
				}
			})
		</script>
	</body>

</html>