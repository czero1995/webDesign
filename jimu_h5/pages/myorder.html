<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
		<title>我的订单</title>
		<script src="../js/rem.js"></script>
		<link rel="stylesheet" href="../css/base.css">
		<link rel="stylesheet" href="../css/myorder.css" />
	</head>

	<body>

		<div id="app">
			<div class="header clearfloat" id="topBar">
				<a href="javascript:history.back(-1)">
					<img src="../img/icon/arrowBack.png" />
				</a>
				<p>我的订单</p>
			</div>
			<div class="container">
				<div class="order-item" v-for="orderItem in orderList" @click="onOrderDetail(orderItem)">
					<div class="order-top inlinkFlex-spacebetween">
						<p>订单号: {{orderItem.order_sn}}</p>
						<p class="order-state">
							<span v-if="orderItem.pay_status == 1 && orderItem.order_status == 0">待收货</span>
							<span v-if="orderItem.pay_status == 1 && orderItem.order_status == 1">已完成</span>
							<span v-if="orderItem.pay_status == 0">待付款</span>
							<span v-if="orderItem.pay_status == 1">已付款</span>
						</p>
					</div>
					<div class="order-content">
						<div v-for="goodsItem in orderItem.goods_list" class="inlinkFlex">
							<div class="order-img">
								<img :src="goodsItem.goods_thumb" />
							</div>
							<div class="order-text ">
								<p class="order-name text-ellipsis">{{goodsItem.goods_name}}</p>
								<p class="order-num">x{{goodsItem.buy_number}}</p>
								<p class="order-coach">¥{{goodsItem.present_price}}</p>
							</div>

						</div>

					</div>
					<div class="order-allCoach">
						<span>商品总额:</span>
						<span class="order-coach">¥{{orderItem.goods_amount}}</span>
					</div>
					<div class="order-op inlinkFlex" v-show="orderItem.pay_status == 0">
						<p>取消订单</p>
						<p class="order-coach">支付</p>
					</div>
					<div class="order-op inlinkFlex"  v-show="orderItem.pay_status == 1 && orderItem.order_status == 0">
						<p class="order-coach">确认收货</p>
					</div>
					
				</div>
			</div>
		</div>
		<script src="../js/axios.js"></script>
		<script src="../js/http.js"></script>
		<script src="../js/vue.js"></script>
		<script>
			new Vue({
				el: '#app',
				data() {
					return {
						orderList: []
					}
				},
				mounted: function() {
					this.getOrderList();
				},
				methods: {
					/*获取订单列表*/
					getOrderList: function() {
						const that = this;
						axios.post(path + 'order/getorderList', {}).then(function(res) {
								that.orderList = res.data.data.data
								console.log('orderList', that.orderList);
							})
							.catch(function(error) {
								console.log(error);
							});
					},
					/*进入订单详情*/
					onOrderDetail(item){						
						if(item.pay_status == 1 && item.order_status == 0){
							location.href="orderwaitDetail.html?id="+item.id;
							console.log('待收货',item.id);
						}else if(item.pay_status == 1 && item.order_status == 1){
							location.href="orderdownDetail.html?id="+item.id;
							console.log('已完成',item.id);
						}else if(item.pay_status == 0){
							location.href="paywaitDetail.html?id="+item.id;
							console.log('待付款',item.id);
						}else if(item.pay_status == 1){
							location.href="paydownDetail.html?id="+item.id;
							console.log('已付款',item.id);
						}
						
						
					}

				}
			})
		</script>
		</body>

			</html>